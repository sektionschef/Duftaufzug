class Pixies{constructor(i){this.inc=i.inc,this.gain=i.gain,this.colorBackground=i.colorBackground,this.colorForeground=i.colorForeground,this.distortion=i.distortion,this.density=i.density,this.margin=i.margin,this.buffer=createGraphics(rescaling_width,rescaling_height),this.totalPixels=this.buffer.width*this.buffer.height*4,this.totalDots=Math.round(this.totalPixels/this.density),this.draw()}draw(){var i=this.density;this.buffer.push(),this.buffer.loadPixels();let r=0;for(let s=0;s<this.buffer.height;s++){let o=0;for(let h=0;h<this.buffer.width;h++){let f=4*(h+s*this.buffer.width);var t=noise(o,r)*this.gain;if(1==softNoiseFeature)var e=t/2;else e=t;void 0!==this.colorBackground&&(this.buffer.pixels[f+0]=red(this.colorBackground),this.buffer.pixels[f+1]=green(this.colorBackground),this.buffer.pixels[f+2]=blue(this.colorBackground),this.buffer.pixels[f+3]=alpha(this.colorBackground)),f%i==0&&f%(4*this.buffer.width)>4*this.margin/exportRatio&&f%(4*this.buffer.width)<4*(this.buffer.width-this.margin/exportRatio)&&f>this.buffer.width*(this.margin/exportRatio)*4&&f<this.totalPixels-this.buffer.width*(this.margin/exportRatio)*4&&(random()>.75?this.draw_big_dot(f,e):this.draw_small_dot(f,t),i=this.density+Math.round(this.density*getRealRandomFromInterval(-this.distortion,this.distortion))),o+=this.inc}r+=this.inc}this.buffer.updatePixels(),this.buffer.pop()}draw_small_dot(i,r){this.buffer.pixels[i+0]=red(this.colorForeground)+r,this.buffer.pixels[i+1]=green(this.colorForeground)+r,this.buffer.pixels[i+2]=blue(this.colorForeground)+r,this.buffer.pixels[i+3]=alpha(this.colorForeground)}draw_big_dot(i,r){this.buffer.pixels[i+0]=red(this.colorForeground)+r,this.buffer.pixels[i+1]=green(this.colorForeground)+r,this.buffer.pixels[i+2]=blue(this.colorForeground)+r,this.buffer.pixels[i+3]=alpha(this.colorForeground),this.buffer.pixels[i-4]=red(this.colorForeground)+r,this.buffer.pixels[i-3]=green(this.colorForeground)+r,this.buffer.pixels[i-2]=blue(this.colorForeground)+r,this.buffer.pixels[i-1]=alpha(this.colorForeground),this.buffer.pixels[i-4*this.buffer.width]=red(this.colorForeground)+r,this.buffer.pixels[i-4*this.buffer.width+1]=green(this.colorForeground)+r,this.buffer.pixels[i-4*this.buffer.width+2]=blue(this.colorForeground)+r,this.buffer.pixels[i-4*this.buffer.width+3]=alpha(this.colorForeground),this.buffer.pixels[i-4*this.buffer.width-4]=red(this.colorForeground)+r,this.buffer.pixels[i-4*this.buffer.width-3]=green(this.colorForeground)+r,this.buffer.pixels[i-4*this.buffer.width-2]=blue(this.colorForeground)+r,this.buffer.pixels[i-4*this.buffer.width-1]=alpha(this.colorForeground)}}